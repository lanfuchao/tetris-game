# 俄罗斯方块游戏

一个功能丰富的现代化俄罗斯方块网页游戏，使用 TypeScript 开发。

## ✨ 主要特性

### 🎮 游戏模式
- **三种难度模式**：简单、普通、困难
- **三种方块类型**：3格、4格（经典）、5格
- **50级通关系统**：达到50级即可通关
- **特殊穿透方块**：金色钻石方块可穿透其他方块

### 🌍 国际化支持
- **中英文双语**：完整的界面翻译
- **一键切换**：点击语言按钮即可切换
- **自动保存**：语言偏好自动保存到本地

### 🎨 精美界面
- **水晶方块**：精美的水晶风格渲染
- **特殊效果**：金色钻石方块带有多层光晕和星光效果
- **响应式设计**：完美支持桌面和移动设备
- **虚拟按键**：触屏设备专用控制按钮

### 📊 数据统计
- **游戏记录**：自动保存每局游戏数据
- **通关次数**：统计不同难度的通关次数
- **历史查询**：按难度筛选游戏记录
- **详细信息**：分数、等级、时长、通关状态

### 🎵 音效系统
- 移动、旋转、落地音效
- 消除行音效
- 游戏结束音效

## 🎯 游戏玩法

### 方块类型

#### 3格方块（Tromino）- 简单模式
- 2种形状：I型、L型
- 无特殊穿透方块
- 最适合新手

#### 4格方块（Tetromino）- 经典模式
- 7种经典形状：I、L、J、O、S、T、Z
- 特殊方块出现概率：简单1%、普通2%、困难5%
- 经典俄罗斯方块体验

#### 5格方块（Pentomino）- 挑战模式
- 8种简化形状：直线、L型、J型、T型等
- 特殊方块出现概率翻倍：简单2%、普通4%、困难10%
- 更大的方块带来更多策略性

### 特殊穿透方块
- **外观**：金色钻石造型，多层光晕和星光效果
- **功能**：可穿透其他方块，直到下方没有空格子
- **用途**：填补难以到达的空隙

### 难度模式

| 难度 | 初始速度 | 最低速度 | 分数倍率 | 升级门槛 | 适合人群 |
|------|---------|---------|---------|---------|---------|
| **简单** | 1000ms | 200ms | 1.0x | 1200分/级 | 新手玩家 |
| **普通** | 800ms | 120ms | 1.5x | 1000分/级 | 有经验玩家 |
| **困难** | 600ms | 80ms | 2.0x | 800分/级 | 高手挑战 |

### 得分规则
- 消除1行：100分（基础分）
- 消除2行：300分
- 消除3行：500分
- 消除4行：800分
- **实际得分** = 基础分 × 当前等级 × 难度倍率

### 通关条件
- 在任意难度下达到 **50级** 即可通关
- 通关后会显示特别的胜利界面
- 通关记录会被永久保存

## 🎮 操作说明

### 键盘控制
- **←** 左移方块
- **→** 右移方块
- **↓** 加速下落（按住）
- **↑** 旋转方块
- **空格** 瞬间落地
- **P** 暂停/继续游戏

### 虚拟按键（移动设备）
- **←** 左移
- **↻** 旋转
- **↓** 加速下落
- **→** 右移
- **落地** 瞬间落地

### 长按支持
所有方向键和旋转键都支持长按连续操作。

## 🚀 快速开始

### 方式一：使用脚本（推荐）

```bash
./start.sh
```

这将自动安装依赖并启动开发服务器。

### 方式二：手动命令

```bash
# 1. 安装依赖
npm install

# 2. 启动开发服务器
npm run dev
```

访问 http://localhost:8080

## 📦 可用命令

| 命令 | 说明 |
|------|------|
| `npm run dev` | 启动开发服务器（支持热重载） |
| `npm run build` | 构建生产版本 |
| `npm run clean` | 清理构建目录 |
| `./start.sh` | 一键启动开发服务器 |
| `./deploy.sh` | 构建并部署生产版本 |

## 🏗️ 技术栈

- **TypeScript** - 类型安全的JavaScript超集
- **Webpack 5** - 现代化模块打包工具
- **HTML5 Canvas** - 高性能图形渲染
- **Web Audio API** - 动态音效系统
- **LocalStorage** - 本地数据持久化

## 📁 项目结构

```
tetris/
├── src/
│   ├── styles/
│   │   └── main.css          # 样式文件
│   ├── utils/
│   │   ├── audio.ts          # 音效管理
│   │   ├── renderer.ts       # 渲染引擎
│   │   └── records.ts        # 记录管理
│   ├── blockShapes.ts        # 方块形状定义
│   ├── config.ts             # 游戏配置
│   ├── difficulty.ts         # 难度系统
│   ├── i18n.ts              # 国际化
│   ├── types.ts             # TypeScript 类型
│   ├── game.ts              # 游戏核心逻辑
│   ├── main.ts              # 入口文件
│   └── index.html           # HTML 模板
├── dist/                     # 构建输出目录
├── webpack.config.js        # Webpack 配置
├── tsconfig.json            # TypeScript 配置
└── package.json             # 项目依赖
```

## 🎨 代码特性

### 模块化设计
- `game.ts` - 游戏主类，管理游戏状态和逻辑
- `difficulty.ts` - 难度系统和速度算法
- `renderer.ts` - 所有渲染操作
- `audio.ts` - 音效系统
- `i18n.ts` - 国际化系统
- `blockShapes.ts` - 方块形状定义
- `records.ts` - 游戏记录管理

### 类型安全
- 完整的 TypeScript 类型定义
- 严格的类型检查
- 接口定义清晰

### 性能优化
- 深拷贝保护，避免意外修改
- 高效的碰撞检测
- 优化的渲染流程
- Canvas 图层管理

## 🚢 部署

### 构建生产版本

```bash
npm run build
```

或使用部署脚本：

```bash
./deploy.sh
```

构建产物在 `dist/` 目录，可以部署到任何静态托管服务：

- **Vercel** - 推荐，自动CI/CD
- **Netlify** - 简单易用
- **GitHub Pages** - 免费托管
- **阿里云 OSS** - 国内访问快
- **腾讯云 COS** - 国内访问快

## 🎮 游戏截图

### 主界面
- 游戏面板：10×20 格子
- 侧边栏：得分、等级、难度、方块类型选择
- 下一个方块预览
- 控制按钮：开始/结束、暂停

### 弹窗
- **帮助**：操作说明、难度说明
- **游戏记录**：历史记录、通关次数、筛选功能
- **游戏结束**：最终统计、重新开始

### 移动端优化
- 紧凑的侧边栏布局
- 底部虚拟按键
- 固定的右上角功能按钮
- 响应式字体和按钮大小

## 🌟 特别功能

### 特殊方块渲染
- 8层视觉效果：
  1. 多层外发光（光晕）
  2. 钻石形状路径
  3. 径向渐变填充（白→金）
  4. 边框描边
  5. 高光线
  6. 顶部亮点
  7. 底部反光
  8. 星光效果（十字光芒）

### 智能速度曲线
- 使用指数衰减算法
- 速度变化更加平滑自然
- 不同难度有不同的速度曲线

### 游戏记录系统
- 自动保存到 LocalStorage
- 记录内容：难度、分数、等级、时长、通关状态
- 按难度筛选查看
- 统计通关次数
- 支持清空记录

## 🔧 开发

### 添加新的方块形状

在 `src/blockShapes.ts` 中定义：

```typescript
export const CUSTOM_SHAPES: Shape[] = [
    [],
    [[1, 1, 1]],  // 形状定义
    // ... 更多形状
];
```

### 添加新的语言

在 `src/i18n.ts` 中添加翻译：

```typescript
export const translations: Record<Language, Translation> = {
    [Language.ZH_CN]: { /* 中文翻译 */ },
    [Language.EN]: { /* 英文翻译 */ },
    // 添加新语言...
};
```

### 修改难度参数

在 `src/difficulty.ts` 中调整：

```typescript
export const DIFFICULTY_CONFIGS: Record<Difficulty, DifficultyConfig> = {
    [Difficulty.EASY]: {
        initialSpeed: 1000,
        minSpeed: 200,
        // ... 其他参数
    }
};
```

## 📝 更新日志

### v2.0.0
- ✨ 添加方块类型选择（3格/4格/5格）
- ✨ 特殊穿透方块系统
- ✨ 完整的中英文国际化
- ✨ 50级通关系统
- ✨ 游戏记录系统
- 🎨 水晶风格方块渲染
- 📱 移动端优化

### v1.0.0
- 🎮 经典俄罗斯方块玩法
- 🎚️ 三种难度模式
- 📈 智能速度曲线
- 🎵 动态音效系统

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 💬 反馈

如有问题或建议，请提交 Issue。

---

⭐ 如果你喜欢这个项目，请给它一个星标！
